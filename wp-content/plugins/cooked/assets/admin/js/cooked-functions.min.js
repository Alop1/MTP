function cooked_init_gallery_sorting(){jQuery("#cooked-recipe-image-gallery").sortable()}function init_nutrition_facts(e){e.find("input").each(function(){var e=jQuery(this),t=e.attr("id"),i=e.val(),o=jQuery('.cooked-nut-percent[data-labeltype="'+t+'"]').length;if(jQuery('.cooked-nut-label[data-labeltype="'+t+'"]').length)if(i){if(jQuery('.cooked-nut-label[data-labeltype="'+t+'"]').html(i),jQuery('.cooked-nut-label[data-labeltype="'+t+'"]').parents("li").eq(0).show(),jQuery('.cooked-nut-label[data-labeltype="'+t+'"]').parents("p").eq(0).show(),o){var a=jQuery('.cooked-nut-percent[data-labeltype="'+t+'"]'),n=a.data("pdv");n&&(thisPercent=Math.round(i/n*100),a.text(thisPercent))}}else jQuery('.cooked-nut-label[data-labeltype="'+t+'"]').html("___ "),jQuery('.cooked-nut-label[data-labeltype="'+t+'"]').parents("li").eq(0).hide(),jQuery('.cooked-nut-label[data-labeltype="'+t+'"]').parents("p").eq(0).hide()})}function cooked_reset_ingredient_builder(){var e=0,t=0;jQuery(".cooked-ingredient-block").each(function(){var i=cooked_get_random_int(1e11,999999999999);t++;var o=jQuery(this);o.hasClass("cooked-ingredient-heading")||e++,o.find("[data-ingredient-part]").each(function(){var e=jQuery(this);if(""==e.attr("name")){var t=e.data("ingredient-part");e.attr("name","_recipe_settings[ingredients]["+i+"]["+t+"]")}})}),e?jQuery(".cooked-ingredient-headers").show():jQuery(".cooked-ingredient-headers").hide(),t?jQuery("#cooked-ingredients-builder").css({"margin-bottom":"20px"}):jQuery("#cooked-ingredients-builder").css({"margin-bottom":"12px"})}function cooked_reset_direction_builder(){var e=0;jQuery(".cooked-direction-block").each(function(){var t=cooked_get_random_int(1e11,999999999999);e++,jQuery(this).find("[data-direction-part]").each(function(){var e=jQuery(this);if(""==e.attr("name")){var i=e.data("direction-part");e.attr("name","_recipe_settings[directions]["+t+"]["+i+"]")}""==e.attr("data-id")&&e.attr("data-id",t),""==e.attr("id")&&(i=(i=e.data("direction-part")).replace("_","-"),e.attr("id","direction-"+t+"-"+i))})}),e?jQuery("#cooked-directions-builder").css({"margin-bottom":"20px"}):jQuery("#cooked-directions-builder").css({"margin-bottom":"12px"})}function cooked_get_random_int(e,t){return Math.floor(Math.random()*(t-e))+e}function cooked_is_int(e){return!(Math.floor(e)!=e||!$.isNumeric(e))}function cooked_init_conditional_field(e){var t=jQuery("#"+e);t.is(":radio")&&jQuery("body").find("input:radio").on("change",function(){t.is(":checked")||jQuery("body").find("[data-condition='"+e+"']").each(function(){jQuery(this).hide()})}),t.on("change",function(){jQuery("#cooked_recipe_settings").addClass("cooked-loading"),window.clearTimeout($_CookedConditionalTimeout),$_CookedConditionalTimeout=window.setTimeout(function(){jQuery("body").find("[data-condition='"+e+"']").each(function(){var e,i=jQuery(this);e=i.is("li")||i.is("span")?"inline-block":"block";var o=i.data("value");o=!!o&&o.split(" "),t.is(":checkbox")&&t.is(":checked")||t.is(":radio")&&t.is(":checked")?i.css({display:e}):t.is(":checkbox")&&!t.is(":checked")?i.hide():!t.is(":checkbox")&&!o&&t.val()||!t.is(":checkbox")&&o&&jQuery.inArray(t.val(),o)>-1?i.css({display:e}):!t.is(":radio")&&!o&&t.val()||!t.is(":radio")&&o&&jQuery.inArray(t.val(),o)>-1?i.css({display:e}):i.hide()}),jQuery("#cooked_recipe_settings").removeClass("cooked-loading")},25)})}var $_CookedConditionalTimeout=!1;!function(e){e(document).ready(function(){var t=e(".cooked-color-field"),i=e("#cooked_recipe_settings").find("select"),o=e("#cooked-recipe-tabs"),a=e("#cooked_recipe_settings"),n=e(".cooked-tooltip"),d=e(".cooked-conditional-hidden"),c=e(".cooked-sortable"),r=e(".cooked-layout-save-default"),l=e(".cooked-shortcode-field"),s=e("#cooked-ingredients-builder"),u=e("#cooked-directions-builder"),p=e("#cooked-recipe-image-gallery"),k=e("#cooked-recipe-tab-content-nutrition"),h=e("#cooked-settings-panel"),_=e("#cooked-settings-tabs");if(t.length&&t.wpColorPicker(),c.length&&c.sortable(),r.length){r.tooltipster({theme:"tooltipster-light",trigger:"click",animation:"grow",delay:0,speed:200,maxWidth:275,contentAsHTML:!0,interactive:!0,functionReady:function(t,i){e(".cooked-save-default-all").on("click",function(t){t.preventDefault();var i=e(this),o=i.parent(),a=confirm(cooked_js_vars.i18n_confirm_save_default_all);if(recipe_editor=tinymce.get("_recipe_settings_content"),recipe_editor_content=recipe_editor.getContent(),a&&!i.hasClass("disabled")){o.find(".button, .button-primary").addClass("disabled");e.post(cooked_js_vars.ajax_url,{action:"cooked_save_default",default_content:recipe_editor_content,update_all:!0},function(e){i.removeClass("button-primary").addClass("button"),i.text(cooked_js_vars.i18n_applied)}).fail(function(e){})}}),e(".cooked-save-default-new").on("click",function(t){t.preventDefault();var i=e(this),o=i.parent(),a=tinymce.get("_recipe_settings_content").getContent();if(!i.hasClass("disabled")){o.find(".button, .button-primary").addClass("disabled");e.post(cooked_js_vars.ajax_url,{action:"cooked_save_default",default_content:a},function(e){i.text(cooked_js_vars.i18n_saved),o.find(".button-primary").removeClass("disabled")}).fail(function(e){})}})}});e(".cooked-layout-load-default").on("click",function(t){t.preventDefault();var i=e(this),o=i.parent(),a=confirm(cooked_js_vars.i18n_confirm_load_default);if(recipe_editor=tinymce.get("_recipe_settings_content"),a&&!i.hasClass("disabled")){o.find(".button, .button-primary").addClass("disabled");e.post(cooked_js_vars.ajax_url,{action:"cooked_load_default"},function(e){recipe_editor.setContent(e),o.find(".button, .button-primary").removeClass("disabled")}).fail(function(e){o.find(".button, .button-primary").removeClass("disabled")})}})}if(i.length&&i.each(function(){e(this).wrap('<div class="cooked-select-wrapper" />')}),n.length&&n.tooltipster({theme:"tooltipster-light",animation:"grow",delay:150,speed:200,maxWidth:275,contentAsHTML:!0,interactive:!0}),l.length&&l.on("click",function(t){e(this).select()}),d.length){var f=[];d.each(function(){var t,i=e(this),o=e(this).data("condition"),a=e(this).data("value"),n=e("#"+o);a=!!a&&a.split(" "),t=i.is("li")||i.is("span")?"inline-block":"block",n.is(":checkbox")&&n.is(":checked")||n.is(":radio")&&n.is(":checked")?i.css({display:t}):n.is(":checkbox")&&!n.is(":checked")||n.is(":radio")&&!n.is(":checked")?i.hide():!n.is(":checkbox")&&!a&&n.val()||!n.is(":checkbox")&&a&&e.inArray(n.val(),a)>-1?i.css({display:t}):!n.is(":radio")&&!a&&n.val()||!n.is(":radio")&&a&&e.inArray(n.val(),a)>-1?i.css({display:t}):i.hide(),-1==e.inArray(o,f)&&f.push(o);for(var d=f.length,c=0;c<d;c++)cooked_init_conditional_field(o)})}if(o.length){var g=o.find("li"),m=o.offset().top-32;e(window).on("load scroll",function(){e(window).scrollTop()>=m?a.addClass("stuck"):a.removeClass("stuck")}),g.on("click",function(t){t.preventDefault(),window.scrollTo(0,0);var i=e(this),o=i.attr("id");o=(o=o.split("cooked-recipe-tab-"))[1],e(".cooked-recipe-tab-content").hide(),e("#cooked-recipe-tab-content-"+o).show(),g.removeClass("active"),i.addClass("active")})}if(_.length||o.length){var v=Array.prototype.slice.call(document.querySelectorAll(".cooked-switch")),b=Array.prototype.slice.call(document.querySelectorAll(".cooked-switch-red")),y=Array.prototype.slice.call(document.querySelectorAll(".cooked-switch-yellow")),w=Array.prototype.slice.call(document.querySelectorAll(".cooked-switch-gray"));v.forEach(function(e){new Switchery(e,{color:"#07a780",size:"small"})}),b.forEach(function(e){new Switchery(e,{color:"#d44d1f",size:"small"})}),y.forEach(function(e){new Switchery(e,{color:"#ffad18",size:"small"})}),w.forEach(function(e){new Switchery(e,{color:"#aaaaaa",size:"small"})})}if(_.length){var j=window.location.hash,C=_.find("li"),Q=_.offset().top-32;if(e(window).on("load scroll",function(){e(window).scrollTop()>=Q?h.addClass("stuck"):h.removeClass("stuck")}),j)x=(x=(x=j).split("#"))[1],_.find("li").removeClass("active"),_.find('a[href="'+j+'"]').parent().addClass("active"),e(".cooked-settings-tab-content").hide(),e("#cooked-settings-tab-content-"+x).show();else{var x=_.find(".active > a").attr("href");x=(x=x.split("#"))[1],e(".cooked-settings-tab-content").hide(),e("#cooked-settings-tab-content-"+x).show()}C.on("click",function(t){window.scrollTo(0,0),e(".tab-content").hide();var i=e(this).find("a");_.find("li").removeClass("active"),e(this).addClass("active");var o=i.attr("href");console.log(o),o=(o=o.split("#"))[1],e(".cooked-settings-tab-content").hide(),e("#cooked-settings-tab-content-"+o).show()})}if(s.length&&(cooked_reset_ingredient_builder(),s.on("keydown",'input[data-ingredient-part="name"]',function(t){9!==t.keyCode&&13!==t.keyCode||e(this).parents(".cooked-ingredient-block").is(":last-child")&&(t.preventDefault(),e("#cooked-recipe-tab-content-ingredients").find(".cooked-add-ingredient-button").trigger("click"),s.find('.cooked-ingredient-block:last-child input[data-ingredient-part="amount"]').focus())}),s.on("keyup",'input[data-ingredient-part="url"]',function(t){var i=e(this).val(),o=e(this).parents(".recipe-setting-block");i?o.addClass("cooked-has-url"):o.removeClass("cooked-has-url")}),s.parent().on("click",".cooked-add-ingredient-button",function(e){e.preventDefault();var t=s.parent().find(".cooked-ingredient-template").clone().removeClass("cooked-template cooked-ingredient-template").addClass("cooked-ingredient-block");s.append(t),cooked_reset_ingredient_builder()}),s.parent().on("click",".cooked-add-heading-button",function(e){e.preventDefault();var t=s.parent().find(".cooked-heading-template").clone().removeClass("cooked-template cooked-heading-template").addClass("cooked-ingredient-block cooked-ingredient-heading");s.append(t),cooked_reset_ingredient_builder()}),s.parent().on("click",".cooked-delete-ingredient",function(t){t.preventDefault(),e(this).parent().remove(),cooked_reset_ingredient_builder()})),u.length){cooked_reset_direction_builder(),u.parent().on("click",".cooked-add-direction-button",function(e){e.preventDefault();var t=u.parent().find(".cooked-direction-template").clone().removeClass("cooked-template cooked-direction-template").addClass("cooked-direction-block");u.append(t),cooked_reset_direction_builder()}),u.parent().on("click",".cooked-add-heading-button",function(e){e.preventDefault();var t=u.parent().find(".cooked-heading-template").clone().removeClass("cooked-template cooked-heading-template").addClass("cooked-direction-block cooked-direction-heading");u.append(t),cooked_reset_direction_builder()}),u.parent().on("click",".cooked-delete-direction",function(t){t.preventDefault(),e(this).parent().remove(),cooked_reset_direction_builder()}),u.parent().on("click",".remove-image-button",function(t){t.preventDefault(),e(this).parent().removeClass("cooked-has-image"),e(this).parent().find("img").remove(),e(this).parent().find('input[data-direction-part="image"]').val(""),cooked_reset_direction_builder()});var D,A;e("body").on("click",".cooked-direction-img-placeholder, .cooked-direction-img",function(t){t.preventDefault(),e(this).parent().find(".direction-image-button").trigger("click")}),e("body").on("click",".direction-image-button",function(t){var i=e(this);A=i.data("id"),t.preventDefault(),D?D.open():((D=wp.media.frames.direction_image_frame=wp.media({title:cooked_js_vars.i18n_image_title,button:{text:cooked_js_vars.i18n_image_button},library:{type:"image"}})).on("select",function(){var t=D.state().get("selection").first().toJSON();e("#direction-"+A+"-image-src").attr("src",t.sizes.thumbnail.url).parent().addClass("cooked-has-image"),e('input[name="_recipe_settings[directions]['+A+'][image]"]').val(t.id),e('.direction-image-button[data-id="'+A+'"]').prop("value",cooked_js_vars.i18n_image_change)}),D.open())})}if(p.length){var q;cooked_init_gallery_sorting(),e("body").on("click",".cooked-gallery-add-button",function(t){e(this);t.preventDefault(),q?q.open():((q=wp.media.frames.gallery_images_frame=wp.media({title:cooked_js_vars.i18n_gallery_image_title,button:{text:cooked_js_vars.i18n_gallery_image_title},library:{type:"image"},multiple:!0})).on("select",function(){var t,i=q.state().get("selection").toJSON();for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];t=a.sizes.thumbnail.url,e("#cooked-recipe-image-gallery").append('<div data-attachment-id="'+a.id+'" class="cooked-recipe-gallery-item"><img src="'+t+'" /><span class="cooked-gallery-item-title">'+a.title+'</span><input type="hidden" name="_recipe_settings[gallery][items][]" value="'+a.id+'" /><a href="#" data-attachment-id="'+a.id+'" class="cooked-gallery-edit-button"><i class="cooked-icon cooked-icon-pencil"></i></a><a href="#" class="remove-image-button"><i class="cooked-icon cooked-icon-times"></i></a></div>')}cooked_init_gallery_sorting()}),q.open())}),e("body").on("click",".cooked-recipe-gallery-item img",function(t){t.preventDefault(),e(this).parent().find(".cooked-gallery-edit-button").trigger("click")}),e("body").on("click",".cooked-gallery-edit-button",function(t){var i=e(this),o=i.data("attachment-id");t.preventDefault();var a=wp.media.frames.gallery_images_frame=wp.media({title:cooked_js_vars.i18n_edit_image_title,button:{text:cooked_js_vars.i18n_edit_image_button},library:{type:"image"},multiple:!1});a.on("open",function(){var e=a.state().get("selection");attachment=wp.media.attachment(o),attachment.fetch(),e.add(attachment?[attachment]:[])}),a.open(),a.on("select",function(){var e,t=a.state().get("selection").toJSON();for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];e=n.sizes.thumbnail.url,i.parent().replaceWith('<div data-attachment-id="'+n.id+'" class="cooked-recipe-gallery-item"><img src="'+e+'" /><span class="cooked-gallery-item-title">'+n.title+'</span><input type="hidden" name="_recipe_settings[gallery][items][]" value="'+n.id+'" /><a href="#" data-attachment-id="'+n.id+'" class="cooked-gallery-edit-button"><i class="cooked-icon cooked-icon-pencil"></i></a><a href="#" class="remove-image-button"><i class="cooked-icon cooked-icon-times"></i></a></div>')}cooked_init_gallery_sorting()})}),p.on("click",".remove-image-button",function(t){var i=e(this);A=i.data("id"),t.preventDefault(),A?(e("#direction-"+A+"-image-src").parent().removeClass("cooked-has-image").prop("src",!1),e('input[name="_recipe_settings[directions]['+A+'][image]"]').val(""),e('.direction-image-button[data-id="'+A+'"]').prop("value",cooked_js_vars.i18n_image_title)):i.parent().remove()})}k.length&&(init_nutrition_facts(k),k.on("keyup","input",function(t){t.preventDefault();var i=e(this),o=i.attr("id"),a=i.val(),n=e('.cooked-nut-percent[data-labeltype="'+o+'"]').length;if(e('.cooked-nut-label[data-labeltype="'+o+'"]').length)if(a){if(e('.cooked-nut-label[data-labeltype="'+o+'"]').html(a),e('.cooked-nut-label[data-labeltype="'+o+'"]').parents("li").eq(0).show(),e('.cooked-nut-label[data-labeltype="'+o+'"]').parents("p").eq(0).show(),n){var d=e('.cooked-nut-percent[data-labeltype="'+o+'"]'),c=d.data("pdv");c&&(thisPercent=Math.round(a/c*100),d.text(thisPercent))}}else e('.cooked-nut-label[data-labeltype="'+o+'"]').html("___ "),e('.cooked-nut-label[data-labeltype="'+o+'"]').parents("li").eq(0).hide(),e('.cooked-nut-label[data-labeltype="'+o+'"]').parents("p").eq(0).hide()}))})}(jQuery);